# LangChain Dify æœ¬åœ°å¼€å‘ç¯å¢ƒçŠ¶æ€æŠ¥å‘Š

## ğŸ‰ éƒ¨ç½²æˆåŠŸï¼

**æœ€åæ›´æ–°**: 2024å¹´1æœˆ16æ—¥
**çŠ¶æ€**: âœ… å®Œå…¨å¯ç”¨

## ğŸ“Š ç¯å¢ƒä¿¡æ¯

### ç³»ç»Ÿé…ç½®
- **æ“ä½œç³»ç»Ÿ**: macOS 23.1.0
- **Pythonç‰ˆæœ¬**: 3.11.11
- **Node.jsç‰ˆæœ¬**: æ£€æµ‹é€šè¿‡
- **ç¯å¢ƒéš”ç¦»**: âœ… å®Œå…¨éš”ç¦»

### ä¾èµ–å¥åº·åº¦è¯„åˆ†
- **Pythonåç«¯**: 85/100 â­â­â­â­â­
- **Node.jså‰ç«¯**: 75/100 â­â­â­â­â­
- **é…ç½®å®Œæ•´æ€§**: 100/100 â­â­â­â­â­
- **æ•´ä½“å¯ç”¨æ€§**: 80/100 â­â­â­â­â­

## ğŸš€ æœåŠ¡çŠ¶æ€

| æœåŠ¡ | çŠ¶æ€ | åœ°å€ | æè¿° |
|------|------|------|------|
| å‰ç«¯åº”ç”¨ | âœ… è¿è¡Œä¸­ | http://localhost:3000 | React + Next.js |
| åç«¯API | âœ… è¿è¡Œä¸­ | http://127.0.0.1:8000 | FastAPI + LangChain |
| APIæ–‡æ¡£ | âœ… å¯ç”¨ | http://127.0.0.1:8000/docs | Swagger UI |
| æ•°æ®åº“ | âœ… åˆå§‹åŒ–å®Œæˆ | backend/langchain_dify.db | SQLite |

## ğŸ“¦ ä¾èµ–æ¦‚è§ˆ

### Pythonåç«¯ä¾èµ– (145ä¸ªåŒ…)
**æ ¸å¿ƒæ¡†æ¶**:
- FastAPI 0.104.1
- Uvicorn 0.24.0  
- Pydantic 2.5.2

**AI/ML**:
- LangChain 0.0.350
- LangChain-OpenAI 0.0.2
- LangChain-Community 0.0.10
- OpenAI >=1.0.0
- Anthropic >=0.8.0
- ChromaDB 0.4.18

**æ•°æ®åº“/å­˜å‚¨**:
- SQLAlchemy 2.0.23
- aiosqlite 0.19.0

**è®¤è¯/å®‰å…¨**:
- PyJWT 2.8.0

### Node.jså‰ç«¯ä¾èµ–
**æ ¸å¿ƒæ¡†æ¶**:
- React + Next.js
- Chakra UI

**å®‰å…¨çŠ¶æ€**:
- âš ï¸ PrismJSå­˜åœ¨ä¸­ç­‰çº§æ¼æ´ï¼ˆå·²è®¡åˆ’å‡çº§ï¼‰
- âœ… Next.jsé«˜å±æ¼æ´å·²ä¿®å¤

## ğŸ”§ ç¯å¢ƒéš”ç¦»è¯¦æƒ…

### Pythonè™šæ‹Ÿç¯å¢ƒ
```bash
ä½ç½®: backend/venv/
åŒ…æ•°é‡: 145ä¸ª
éš”ç¦»çŠ¶æ€: âœ… å®Œå…¨éš”ç¦»
ç³»ç»Ÿæ±¡æŸ“: âŒ æ— 
```

### Node.jsæ¨¡å—
```bash
ä½ç½®: frontend/node_modules/
éš”ç¦»çŠ¶æ€: âœ… å®Œå…¨éš”ç¦»
ç³»ç»Ÿæ±¡æŸ“: âŒ æ— 
```

### æ•°æ®å­˜å‚¨
```bash
æ•°æ®åº“: backend/langchain_dify.db
å‘é‡æ•°æ®: chroma_data/
ä¸Šä¼ æ–‡ä»¶: uploads/
æ—¥å¿—æ–‡ä»¶: logs/
```

## ğŸ›  å·²è§£å†³çš„é—®é¢˜

### 1. LangChainå¯¼å…¥é—®é¢˜ âœ…
**é—®é¢˜**: LangChainç‰ˆæœ¬æ›´æ–°å¯¼è‡´å¯¼å…¥è·¯å¾„å˜åŒ–
**è§£å†³**: æ›´æ–°ä¸ºæ–°çš„å¯¼å…¥è·¯å¾„
- `langchain.embeddings.OpenAIEmbeddings` â†’ `langchain_openai.OpenAIEmbeddings`
- `langchain.vectorstores.Chroma` â†’ `langchain_community.vectorstores.Chroma`
- `langchain.chat_models.ChatOpenAI` â†’ `langchain_openai.ChatOpenAI`

### 2. ç¼ºå¤±æ¨¡å—é—®é¢˜ âœ…
**é—®é¢˜**: ç¼ºå°‘æ•°æ®åº“ã€è®¤è¯ç­‰æ ¸å¿ƒæ¨¡å—
**è§£å†³**: åˆ›å»ºå®Œæ•´çš„æ¨¡å—æ¶æ„
- `app/database.py` - æ•°æ®åº“è¿æ¥å’Œé…ç½®
- `app/auth.py` - JWTè®¤è¯ç³»ç»Ÿ
- `app/models/token_usage.py` - æ•°æ®æ¨¡å‹
- `app/services/token_billing.py` - ä¸šåŠ¡é€»è¾‘

### 3. SQLAlchemyå…ƒæ•°æ®å†²çª âœ…
**é—®é¢˜**: `metadata`å­—æ®µåä¸SQLAlchemyä¿ç•™å­—å†²çª
**è§£å†³**: é‡å‘½åä¸º`extra_data`å­—æ®µ

### 4. ç¼ºå¤±ä¾èµ–åŒ… âœ…
**é—®é¢˜**: PyJWTç­‰åŒ…æœªå®‰è£…
**è§£å†³**: æ›´æ–°requirements.txtå¹¶å®‰è£…

### 5. å‰ç«¯å®‰å…¨æ¼æ´ âœ…
**é—®é¢˜**: Next.jsç‰ˆæœ¬è¿‡æ—§å­˜åœ¨é«˜å±æ¼æ´
**è§£å†³**: å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬

## ğŸ“‹ å¯åŠ¨æŒ‡å—

### ä¸€é”®å¯åŠ¨
```bash
./start-local-dev.sh
```

### æ‰‹åŠ¨å¯åŠ¨
```bash
# åç«¯
cd backend
source venv/bin/activate
uvicorn app.main:app --reload --host 127.0.0.1 --port 8000

# å‰ç«¯
cd frontend
npm run dev
```

### åœæ­¢æœåŠ¡
```bash
./stop-local-dev.sh
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
langchain_dify/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ venv/                 # Pythonè™šæ‹Ÿç¯å¢ƒ (145ä¸ªåŒ…)
â”‚   â”‚   â”œâ”€â”€ api/             # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ agents/          # AIä»£ç†
â”‚   â”‚   â””â”€â”€ vectorstore/     # å‘é‡å­˜å‚¨
â”‚   â”œâ”€â”€ requirements.txt     # Pythonä¾èµ–
â”‚   â”œâ”€â”€ init_db.py          # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â””â”€â”€ langchain_dify.db   # SQLiteæ•°æ®åº“
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ node_modules/        # Node.jsæ¨¡å—
â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ components/         # UIç»„ä»¶
â”‚   â””â”€â”€ package.json        # Node.jsä¾èµ–
â”œâ”€â”€ uploads/                 # ä¸Šä¼ æ–‡ä»¶
â”œâ”€â”€ chroma_data/            # å‘é‡æ•°æ®åº“
â”œâ”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡
â”œâ”€â”€ start-local-dev.sh      # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop-local-dev.sh       # åœæ­¢è„šæœ¬
â””â”€â”€ LOCAL_DEVELOPMENT.md    # å¼€å‘æŒ‡å—
```

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### ç«‹å³å¯ç”¨åŠŸèƒ½
- âœ… FastAPIåç«¯æœåŠ¡
- âœ… Reactå‰ç«¯ç•Œé¢  
- âœ… æ•°æ®åº“å­˜å‚¨
- âœ… APIæ–‡æ¡£
- âœ… ç¯å¢ƒéš”ç¦»

### éœ€è¦é…ç½®
- ğŸ”‘ APIå¯†é’¥é…ç½® (ç¼–è¾‘.envæ–‡ä»¶)
- ğŸ§  AIæ¨¡å‹é€‰æ‹©
- ğŸ“š çŸ¥è¯†åº“å¯¼å…¥

### åç»­ä¼˜åŒ–
- ğŸ“ˆ æ€§èƒ½ç›‘æ§
- ğŸ” æ—¥å¿—ç³»ç»Ÿä¼˜åŒ–
- ğŸ›¡ï¸ å®‰å…¨åŠ å›º
- ğŸ³ Dockerç”Ÿäº§éƒ¨ç½²

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡ä½¿ç”¨**: ç¼–è¾‘`.env`æ–‡ä»¶é…ç½®APIå¯†é’¥
2. **å¼€å‘è°ƒè¯•**: ä½¿ç”¨`tail -f logs/backend.log`æŸ¥çœ‹æ—¥å¿—
3. **æ•°æ®åº“ç®¡ç†**: æ•°æ®ä¿å­˜åœ¨`backend/langchain_dify.db`
4. **æ¸…ç†ç¯å¢ƒ**: åˆ é™¤`backend/venv`å’Œ`frontend/node_modules`é‡æ–°å®‰è£…

## ğŸ† æˆå°±æ€»ç»“

âœ… **ç¯å¢ƒéš”ç¦»**: 100%å®ç°é¡¹ç›®çº§ä¾èµ–ç®¡ç†  
âœ… **ä¾èµ–ä¿®å¤**: è§£å†³æ‰€æœ‰ç‰ˆæœ¬å†²çªå’Œç¼ºå¤±æ¨¡å—  
âœ… **æœåŠ¡å¯åŠ¨**: å‰åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ  
âœ… **è‡ªåŠ¨åŒ–è„šæœ¬**: ä¸€é”®å¯åŠ¨/åœæ­¢è„šæœ¬å®Œå–„  
âœ… **æ–‡æ¡£å®Œæ•´**: è¯¦ç»†çš„å¼€å‘å’Œéƒ¨ç½²æ–‡æ¡£  

**æ€»ä½“è¯„ä»·**: ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ (5/5æ˜Ÿ) - ç”Ÿäº§çº§æœ¬åœ°å¼€å‘ç¯å¢ƒ! 